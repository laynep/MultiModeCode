Notebook[{

Cell[CellGroupData[{
Cell["ModeCode Engine", "Title",
 CellChangeTimes->{3.580857601837193*^9}],

Cell["Multifield Background and Perturbation Solver", "Subtitle",
 CellChangeTimes->{3.580857609893817*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<DifferentialEquations`InterpolatingFunctionAnatomy`\>\"",
    "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<DifferentialEquations`NDSolveProblems`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
  "Needs", "[", "\"\<DifferentialEquations`NDSolveUtilities`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Needs", "[", "\"\<FunctionApproximations`\>\"", "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.580857834707092*^9, 3.580857834904495*^9}}],

Cell[CellGroupData[{

Cell["Define Potential and Derivatives", "Section",
 CellChangeTimes->{3.580857623625631*^9}],

Cell[TextData[StyleBox["Use ?(VectorQ[#, NumericQ] &) to let the function \
know it\[CloseCurlyQuote]s supposed to accept vectors, not pre-evaluate \
things like V[\[Phi][\[Alpha]]] with \[Phi] as a scalar", "Text"]], "Text",
 CellChangeTimes->{
  3.580857634039861*^9, {3.580858105963747*^9, 3.580858106179921*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"m2", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{"-", "10.422895047377294"}], ")"}]}], ",", 
      RowBox[{"10", "^", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "10.422895047377294"}], "+", 
         RowBox[{"Log10", "[", "81.0", "]"}]}], ")"}]}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"V", "[", 
    RowBox[{"\[Phi]_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VectorQ", "[", "#", "]"}], " ", "&"}], ")"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1.", "/", "2"}], ")"}], 
    RowBox[{"m2", ".", 
     RowBox[{"(", 
      RowBox[{"\[Phi]", "*", "\[Phi]"}], ")"}]}]}]}], "   ", 
  RowBox[{"(*", "Scalar", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"dVd\[Phi]", "[", 
    RowBox[{"\[Phi]_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VectorQ", "[", "#", "]"}], " ", "&"}], ")"}]}], "]"}], ":=", 
   RowBox[{"m2", "*", "\[Phi]"}]}], "  ", 
  RowBox[{"(*", "Vector", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m2matrix", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"m2", "[", 
       RowBox[{"[", "1", "]"}], "]"}], ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", 
      RowBox[{"m2", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "}"}], " ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Hessian", " ", "matrix", " ", "for", " ", "V"}], ",", " ", 
    RowBox[{
     RowBox[{"ddV", "/", "d\[Phi]_id\[Phi]"}], "_j"}]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.58076651484524*^9, 3.580766516841665*^9}, {
   3.580766684887984*^9, 3.58076670950583*^9}, {3.580771325628658*^9, 
   3.58077137533566*^9}, 3.580777734726744*^9, 3.580778534084891*^9, {
   3.580857932786527*^9, 3.580857932999793*^9}, {3.581020293522963*^9, 
   3.581020306835473*^9}, 3.581021673034738*^9, 3.581028833318485*^9, {
   3.581185853580558*^9, 3.581185854833504*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Cosmology Functions --- scalars", "Section",
 CellChangeTimes->{{3.580857731993374*^9, 3.580857755986649*^9}}],

Cell[CellGroupData[{

Cell["General", "Subsection",
 CellChangeTimes->{{3.581191010073071*^9, 3.58119101059491*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Epsilon]", "[", 
    RowBox[{"d\[Phi]_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VectorQ", "[", "#", "]"}], "&"}], ")"}]}], "]"}], ":=", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{"d\[Phi]", ".", "d\[Phi]"}], ")"}]}]}], " ", 
  RowBox[{"(*", 
   RowBox[{"Also", " ", "=", " ", 
    RowBox[{"KE", "/", 
     SuperscriptBox["H", "2"]}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H", "[", 
    RowBox[{"\[Phi]_", ",", "d\[Phi]_"}], "]"}], ":=", 
   RowBox[{"Sqrt", "[", 
    FractionBox[
     RowBox[{"V", "[", "\[Phi]", "]"}], 
     RowBox[{"3.", "-", 
      RowBox[{"\[Epsilon]", "[", "d\[Phi]", "]"}]}]], "]"}]}], 
  RowBox[{"(*", 
   RowBox[{"G", "=", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       SubscriptBox["M", "P"], "2"], "/", "8"}], "\[Pi]"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"H2", "[", 
    RowBox[{"\[Phi]_", ",", "d\[Phi]_"}], "]"}], ":=", 
   FractionBox[
    RowBox[{"V", "[", "\[Phi]", "]"}], 
    RowBox[{"3.", "-", 
     RowBox[{"\[Epsilon]", "[", "d\[Phi]", "]"}]}]]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KE", "[", 
    RowBox[{"\[Phi]_", ",", "d\[Phi]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"H2", "[", 
     RowBox[{"\[Phi]", ",", "d\[Phi]"}], "]"}], 
    RowBox[{"\[Epsilon]", "[", "d\[Phi]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"weqnstate", "[", "d\[Phi]_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     FractionBox["2", "3"], 
     RowBox[{"\[Epsilon]", "[", "d\[Phi]", "]"}]}], "-", "1."}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", "[", "\[Alpha]_", "]"}], ":=", 
  RowBox[{"a0", " ", 
   RowBox[{"Exp", "[", "\[Alpha]", "]"}]}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.580674681551624*^9, 3.580674760363608*^9}, {
   3.580675130019357*^9, 3.580675133586377*^9}, {3.580675377707961*^9, 
   3.580675399253677*^9}, {3.58067548600621*^9, 3.58067549229268*^9}, {
   3.580676284943541*^9, 3.580676298150949*^9}, {3.580676708968756*^9, 
   3.580676803894329*^9}, {3.580676923743787*^9, 3.580676953972595*^9}, 
   3.580677097783474*^9, {3.580679619145484*^9, 3.580679634540499*^9}, {
   3.580682183859893*^9, 3.580682191118032*^9}, {3.580683168451305*^9, 
   3.580683169847095*^9}, {3.580684776181261*^9, 3.58068477659755*^9}, {
   3.580684827571977*^9, 3.580684828209452*^9}, {3.580684951643981*^9, 
   3.58068495449289*^9}, {3.580758961393017*^9, 3.580759018176546*^9}, {
   3.580764383917068*^9, 3.580764404163507*^9}, 3.580764530079741*^9, {
   3.580771409436032*^9, 3.580771421577495*^9}, {3.580773358504419*^9, 
   3.580773472226832*^9}, {3.580773795241287*^9, 3.580773831822586*^9}, {
   3.580776431957805*^9, 3.580776432398422*^9}, {3.580848188713658*^9, 
   3.580848232654896*^9}, {3.580857854780174*^9, 3.580857858142083*^9}, {
   3.581023121101023*^9, 3.581023134253608*^9}, {3.581109115139641*^9, 
   3.581109142950095*^9}, 3.581113540276611*^9, {3.581191536849046*^9, 
   3.581191626561059*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Slow Roll", "Subsection",
 CellChangeTimes->{{3.581191001753367*^9, 3.581191004328622*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Epsilon]SR", "[", 
   RowBox[{"\[Phi]_", "?", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"VectorQ", "[", "#", "]"}], "&"}], ")"}]}], "]"}], ":=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"V", "[", "\[Phi]", "]"}], "2"]}]], 
   RowBox[{
    RowBox[{"dVd\[Phi]", "[", "\[Phi]", "]"}], ".", 
    RowBox[{"dVd\[Phi]", "[", "\[Phi]", "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HSR", "[", "\[Phi]_", "]"}], ":=", 
  RowBox[{"Sqrt", "[", 
   FractionBox[
    RowBox[{"V", "[", "\[Phi]", "]"}], "3."], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H2SR", "[", "\[Phi]_", "]"}], ":=", 
  FractionBox[
   RowBox[{"V", "[", "\[Phi]", "]"}], "3"]}]}], "Input",
 CellChangeTimes->{{3.581191409319173*^9, 3.581191470255642*^9}, {
  3.581191508103404*^9, 3.581191530798353*^9}, {3.581191609999913*^9, 
  3.581191685225795*^9}, {3.581191847339027*^9, 3.581191854179633*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Set Parameters and Initial Conditions", "Section",
 CellChangeTimes->{3.58085764356358*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"\[Phi]0", "=", 
    RowBox[{"{", 
     RowBox[{"10.31001", ",", "12.93651"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"\[Phi]0", "=", 
     RowBox[{"{", 
      RowBox[{"13", ",", "13"}], "}"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"d\[Phi]0", "=", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"dVd\[Phi]", "[", "\[Phi]0", "]"}], 
      RowBox[{"3", " ", 
       RowBox[{"H2SR", "[", "\[Phi]0", "]"}]}]]}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"slow", " ", "roll", " ", 
    RowBox[{"w", "/", "negligble"}], " ", "KE", " ", "contrib"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Set", " ", "other"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a0", "=", "1."}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Npivot", "=", "55"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Mpc2Mpl", "=", "2.6245*^-57"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"kpivot", "=", 
    RowBox[{".002", " ", "Mpc2Mpl"}]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "Specify", " ", "in", " ", "Mpc", " ", "and", " ", "converts", " ", "to", 
    " ", 
    SuperscriptBox[
     SubscriptBox["M", "Pl"], 
     RowBox[{"-", "1"}]]}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.580682758555876*^9, 3.580682794439814*^9}, {
   3.580682951205136*^9, 3.58068295706301*^9}, {3.580683230166759*^9, 
   3.580683235082072*^9}, 3.580683732992644*^9, {3.580684287353712*^9, 
   3.580684288003732*^9}, {3.580684378266436*^9, 3.580684412512316*^9}, {
   3.580684858044544*^9, 3.58068486185786*^9}, {3.580759776123397*^9, 
   3.580759782894651*^9}, 3.58076011008255*^9, {3.5807603594566*^9, 
   3.580760360177565*^9}, {3.580762317702638*^9, 3.580762327696071*^9}, {
   3.580762549502399*^9, 3.58076256834792*^9}, {3.580762631476859*^9, 
   3.580762636428616*^9}, {3.580762747121856*^9, 3.58076275941746*^9}, {
   3.580764562793563*^9, 3.580764636488595*^9}, {3.580771765088671*^9, 
   3.580771769073398*^9}, {3.580776595901836*^9, 3.580776599757095*^9}, 
   3.580777591175517*^9, 3.58077854044252*^9, {3.580853460016531*^9, 
   3.580853473701898*^9}, {3.58085784531953*^9, 3.58085784910684*^9}, 
   3.580857967789596*^9, {3.581016056497684*^9, 3.581016061872933*^9}, {
   3.581016147585834*^9, 3.581016151843206*^9}, {3.581017354656852*^9, 
   3.581017373148123*^9}, {3.581100425626936*^9, 3.581100428341454*^9}, {
   3.581101415642912*^9, 3.581101419101285*^9}, 3.581110055593028*^9, {
   3.581110327594866*^9, 3.581110330997781*^9}, {3.581110754623985*^9, 
   3.581110757510044*^9}, {3.58111355285756*^9, 3.581113552919378*^9}, 
   3.581113613604075*^9, {3.581113655369458*^9, 3.581113690113758*^9}, {
   3.581113998668329*^9, 3.581113998723929*^9}, 3.581124133539538*^9, {
   3.581124191973198*^9, 3.581124199710063*^9}, {3.581124258487084*^9, 
   3.58112426015324*^9}, {3.581124307385537*^9, 3.581124311581691*^9}, {
   3.581124383517005*^9, 3.581124384801209*^9}, {3.581124532944949*^9, 
   3.581124534559438*^9}, {3.581124831912974*^9, 3.581124836141021*^9}, {
   3.581124871017408*^9, 3.581124871576567*^9}, {3.581124914033505*^9, 
   3.581124916892855*^9}, {3.581125066318525*^9, 3.581125090353993*^9}, {
   3.581125217108664*^9, 3.581125276307027*^9}, {3.581125410928985*^9, 
   3.581125442289007*^9}, {3.58112548218662*^9, 3.581125482728389*^9}, {
   3.581191822546079*^9, 3.581191860709602*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Background Solver", "Section",
 CellChangeTimes->{{3.580857682233987*^9, 3.580857685026706*^9}}],

Cell["Evolve background until end of inflation", "Text",
 CellChangeTimes->{{3.580857697635353*^9, 3.580857699025787*^9}}],

Cell[CellGroupData[{

Cell["Background Equations", "Subsection",
 CellChangeTimes->{{3.580857784161415*^9, 3.580857786058447*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"kgeqn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"d\[Phi]", "'"}], "[", "\[Alpha]", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "-", 
          RowBox[{"\[Epsilon]", "[", 
           RowBox[{"d\[Phi]", "[", "\[Alpha]", "]"}], "]"}]}], ")"}], 
        RowBox[{"d\[Phi]", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         FractionBox["1", 
          RowBox[{"H2", "[", 
           RowBox[{
            RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], ",", 
            RowBox[{"d\[Phi]", "[", "\[Alpha]", "]"}]}], "]"}]], ")"}], 
        RowBox[{"dVd\[Phi]", "[", 
         RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "]"}]}]}], "\[Equal]", 
      "0"}], ",", "\[IndentingNewLine]", " ", 
     RowBox[{
      RowBox[{"d\[Phi]", "[", "\[Alpha]", "]"}], "==", 
      RowBox[{
       RowBox[{"\[Phi]", "'"}], "[", "\[Alpha]", "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Phi]", "[", "0", "]"}], "\[Equal]", "\[Phi]0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d\[Phi]", "[", "0", "]"}], "\[Equal]", "d\[Phi]0"}]}], "}"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.580673182243431*^9, 3.580673191753762*^9}, {
   3.580673990271602*^9, 3.580674009395801*^9}, {3.580674090885081*^9, 
   3.580674091579571*^9}, 3.580675183046353*^9, {3.580675216976145*^9, 
   3.5806752340151*^9}, {3.580675281933912*^9, 3.580675358320064*^9}, {
   3.580675504082036*^9, 3.580675542061685*^9}, {3.580675580760197*^9, 
   3.580675625336132*^9}, {3.580676856923152*^9, 3.580676888361354*^9}, 
   3.580677513208761*^9, {3.580678823068553*^9, 3.580678866143317*^9}, {
   3.580679419654574*^9, 3.580679485282382*^9}, {3.580679568737988*^9, 
   3.580679577978491*^9}, {3.580679638630309*^9, 3.580679639743004*^9}, {
   3.580679712678544*^9, 3.580679728324394*^9}, {3.580680793748465*^9, 
   3.58068081158615*^9}, 3.58068097979736*^9, {3.580681509768722*^9, 
   3.58068151393727*^9}, {3.580681777179855*^9, 3.580681805970356*^9}, {
   3.580682330325386*^9, 3.580682399430808*^9}, 3.580759321245052*^9, 
   3.580760330060726*^9, {3.580762003001998*^9, 3.580762035335165*^9}, {
   3.580762069378211*^9, 3.580762072152883*^9}, 3.580762285598848*^9, {
   3.580764445698*^9, 3.580764449651905*^9}, {3.580765449270306*^9, 
   3.580765484730804*^9}, 3.580771524387938*^9, {3.580773661257434*^9, 
   3.58077367401275*^9}, 3.580773775617428*^9, {3.580773862853437*^9, 
   3.580773864824641*^9}, 3.580776586048234*^9, {3.580850213525798*^9, 
   3.580850221960537*^9}, {3.580857788455001*^9, 3.580857788916102*^9}, 
   3.581016144984848*^9, 3.581022943184361*^9, {3.58119187839069*^9, 
   3.581191884992493*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Engine", "Subsection",
 CellChangeTimes->{{3.580857794777887*^9, 3.580857795234956*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]end", "=", "1000000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"background", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{"kgeqn", ",", 
     RowBox[{"{", 
      RowBox[{"\[Phi]", ",", "d\[Phi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0", ",", "\[Alpha]end"}], "}"}], ",", 
     RowBox[{"Method", " ", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<EventLocator\>\"", ",", 
        RowBox[{"\"\<Event\>\"", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"\[Epsilon]", "[", 
            RowBox[{"d\[Phi]", "[", "\[Alpha]", "]"}], "]"}], "-", "1."}], 
          "}"}]}], ",", 
        RowBox[{"\"\<EventAction\>\"", "\[RuleDelayed]", 
         RowBox[{"{", 
          RowBox[{"Throw", "[", 
           RowBox[{"Null", ",", " ", "\"\<StopIntegration\>\""}], "]"}], 
          "}"}]}]}], "}"}]}], ",", 
     RowBox[{"Method", "\[Rule]", "\"\<BDF\>\""}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]end", " ", "=", " ", 
  RowBox[{
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"InterpolatingFunctionDomain", "[", 
      RowBox[{"First", "[", 
       RowBox[{"\[Phi]", " ", "/.", "background"}], "]"}], "]"}], ",", "1"}], 
    "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]exit", "=", 
  RowBox[{"\[Alpha]end", "-", "Npivot"}]}]}], "Input",
 CellChangeTimes->{{3.580680277915251*^9, 3.580680280099182*^9}, {
   3.580680400932314*^9, 3.580680418277269*^9}, {3.580680603645959*^9, 
   3.580680626378966*^9}, 3.580680864238819*^9, {3.580680917390745*^9, 
   3.580680918864588*^9}, 3.58068096463529*^9, {3.580681099058112*^9, 
   3.580681103472931*^9}, {3.580681281489835*^9, 3.580681289201413*^9}, {
   3.580682065550435*^9, 3.580682068754941*^9}, {3.580682384534755*^9, 
   3.580682391145324*^9}, {3.580683307031961*^9, 3.58068339785706*^9}, {
   3.580683442052231*^9, 3.580683491670694*^9}, {3.580683637191966*^9, 
   3.580683676842484*^9}, 3.580684437936914*^9, {3.580684527855185*^9, 
   3.580684598291595*^9}, {3.580684920352086*^9, 3.580684935753966*^9}, {
   3.580685158722582*^9, 3.580685159509133*^9}, {3.580762058301507*^9, 
   3.58076206420022*^9}, {3.580771633115419*^9, 3.580771641844033*^9}, {
   3.580771676509135*^9, 3.580771722219262*^9}, {3.580771804139577*^9, 
   3.580771809331786*^9}, {3.580848002238932*^9, 3.580848056783169*^9}, 
   3.580849201119838*^9, {3.580849822051678*^9, 3.580849921459274*^9}, 
   3.58084997158396*^9, {3.580850085047724*^9, 3.580850086713695*^9}, {
   3.580850117687199*^9, 3.580850131431683*^9}, {3.580850168372328*^9, 
   3.580850251225759*^9}, {3.580850375984724*^9, 3.580850381329697*^9}, {
   3.58085070291783*^9, 3.580850755424419*^9}, {3.580850785678675*^9, 
   3.580850818940458*^9}, {3.580850937149891*^9, 3.580850939124289*^9}, {
   3.580851533479801*^9, 3.580851580252033*^9}, {3.580852207950959*^9, 
   3.580852218211034*^9}, {3.580852804513773*^9, 3.580852807543163*^9}, {
   3.58085292231547*^9, 3.580852925961234*^9}, {3.580852959440255*^9, 
   3.58085298411834*^9}, {3.580853018872848*^9, 3.580853029522147*^9}, {
   3.580857032631649*^9, 3.580857033786414*^9}, {3.580857688533246*^9, 
   3.580857700700214*^9}, {3.580860407333777*^9, 3.580860407595338*^9}, {
   3.580861278704232*^9, 3.580861279990953*^9}, {3.580862370890885*^9, 
   3.580862376223106*^9}, {3.581016050746611*^9, 3.581016051463242*^9}, {
   3.581018594312417*^9, 3.581018599529719*^9}, 3.581022953865452*^9, 
   3.581109148753227*^9, {3.581109504510836*^9, 3.581109515314204*^9}}],

Cell[BoxData["69.68134029100206`"], "Output",
 CellChangeTimes->{
  3.580680626880686*^9, 3.580680741921419*^9, 3.580680827173504*^9, 
   3.58068086584886*^9, 3.580680919550401*^9, 3.580680964991293*^9, {
   3.580681090579116*^9, 3.580681103797998*^9}, {3.580681278786426*^9, 
   3.580681296375632*^9}, {3.580681404636532*^9, 3.580681434425297*^9}, 
   3.580681518121801*^9, 3.580681763400054*^9, {3.580682062543356*^9, 
   3.580682068973827*^9}, {3.580682375889111*^9, 3.580682385114364*^9}, 
   3.580683182359728*^9, 3.580683242987722*^9, {3.580683399757669*^9, 
   3.580683492594767*^9}, {3.580683651906568*^9, 3.580683677438596*^9}, 
   3.580683739955552*^9, {3.580684419506109*^9, 3.580684438861991*^9}, {
   3.580684534667762*^9, 3.580684541441492*^9}, {3.58068457656364*^9, 
   3.580684598435437*^9}, {3.580684839948938*^9, 3.580684841150137*^9}, 
   3.58068487754685*^9, {3.580684913482597*^9, 3.580684937136863*^9}, {
   3.580685162023303*^9, 3.58068517210039*^9}, 3.580759052232645*^9, 
   3.580760276519058*^9, {3.580761518161217*^9, 3.580761520182945*^9}, 
   3.580761924667168*^9, {3.580762049273114*^9, 3.580762076584883*^9}, 
   3.580762769243443*^9, {3.580764429531456*^9, 3.580764452739483*^9}, 
   3.580766726862776*^9, 3.58077145195601*^9, 3.580771643114147*^9, {
   3.580771711991204*^9, 3.58077172726698*^9}, {3.580771760091451*^9, 
   3.580771809734677*^9}, {3.580773482006782*^9, 3.580773486545247*^9}, 
   3.580773644272273*^9, 3.58077368821571*^9, 3.580773765225314*^9, 
   3.580773822265229*^9, 3.580773868656042*^9, 3.580777106153455*^9, 
   3.580778393102353*^9, 3.580778551072476*^9, 3.580778754040413*^9, 
   3.580842371259697*^9, {3.580848003302743*^9, 3.580848057637833*^9}, 
   3.580849608204505*^9, {3.580849957510611*^9, 3.580849971898356*^9}, 
   3.580850087703205*^9, 3.580850132531482*^9, {3.580850237151051*^9, 
   3.580850252210787*^9}, 3.580850381937146*^9, {3.580850803906042*^9, 
   3.580850820230302*^9}, {3.580850931068059*^9, 3.580850940349092*^9}, {
   3.580851534952309*^9, 3.580851581077577*^9}, 3.580852808132929*^9, 
   3.5808529270696*^9, {3.58085299046554*^9, 3.580853030171203*^9}, 
   3.580853478173158*^9, 3.580857862373387*^9, 3.580860408513193*^9, 
   3.58086237815889*^9, {3.581016137419236*^9, 3.581016162091246*^9}, 
   3.581018602875028*^9, 3.581019469948588*^9, 3.581019704395022*^9, 
   3.581019958195545*^9, 3.581020313321648*^9, 3.581020346324158*^9, 
   3.58102064775095*^9, 3.581021161030884*^9, 3.581021192828865*^9, 
   3.58102134560542*^9, 3.58102167871883*^9, 3.581021767559388*^9, 
   3.581023139184173*^9, 3.581023468792723*^9, 3.581024904341086*^9, 
   3.581028253853307*^9, 3.5810288397029*^9, 3.581028913733025*^9, 
   3.581099035795202*^9, 3.581099362335429*^9, 3.581100432996649*^9, 
   3.581101422860704*^9, 3.581103414174957*^9, 3.581105336940593*^9, 
   3.58110905162031*^9, 3.581109178155017*^9, 3.581109516536592*^9, 
   3.58111006034632*^9, 3.58111033542062*^9, 3.581110449836435*^9, 
   3.581110762204292*^9, 3.581113556488668*^9, 3.581113617689966*^9, 
   3.581113662879137*^9, 3.581114019224538*^9, {3.581120228665361*^9, 
   3.581120254041858*^9}, 3.581120475298985*^9, 3.581120557599889*^9, 
   3.581121893773162*^9, 3.581124136559009*^9, 3.581124203514402*^9, {
   3.581124263856774*^9, 3.581124274978007*^9}, 3.581124317343927*^9, {
   3.581124389109431*^9, 3.581124405539411*^9}, 3.581124541100948*^9, 
   3.581124839446727*^9, 3.581124875279239*^9, 3.581124920061087*^9, 
   3.581125092930397*^9, 3.581125279398108*^9, 3.581125357113795*^9, 
   3.581125418824626*^9, 3.581125450614985*^9, 3.581125486682164*^9, 
   3.581131168703098*^9, 3.581186077883707*^9, 3.581186923433724*^9, 
   3.581190913539697*^9, 3.581191691040564*^9, 3.581192126864022*^9, 
   3.5811945828689*^9, 3.581729594548921*^9, 3.581735446056905*^9, 
   3.581737499693535*^9, 3.581737888834468*^9}],

Cell[BoxData["14.681340291002059`"], "Output",
 CellChangeTimes->{
  3.580680626880686*^9, 3.580680741921419*^9, 3.580680827173504*^9, 
   3.58068086584886*^9, 3.580680919550401*^9, 3.580680964991293*^9, {
   3.580681090579116*^9, 3.580681103797998*^9}, {3.580681278786426*^9, 
   3.580681296375632*^9}, {3.580681404636532*^9, 3.580681434425297*^9}, 
   3.580681518121801*^9, 3.580681763400054*^9, {3.580682062543356*^9, 
   3.580682068973827*^9}, {3.580682375889111*^9, 3.580682385114364*^9}, 
   3.580683182359728*^9, 3.580683242987722*^9, {3.580683399757669*^9, 
   3.580683492594767*^9}, {3.580683651906568*^9, 3.580683677438596*^9}, 
   3.580683739955552*^9, {3.580684419506109*^9, 3.580684438861991*^9}, {
   3.580684534667762*^9, 3.580684541441492*^9}, {3.58068457656364*^9, 
   3.580684598435437*^9}, {3.580684839948938*^9, 3.580684841150137*^9}, 
   3.58068487754685*^9, {3.580684913482597*^9, 3.580684937136863*^9}, {
   3.580685162023303*^9, 3.58068517210039*^9}, 3.580759052232645*^9, 
   3.580760276519058*^9, {3.580761518161217*^9, 3.580761520182945*^9}, 
   3.580761924667168*^9, {3.580762049273114*^9, 3.580762076584883*^9}, 
   3.580762769243443*^9, {3.580764429531456*^9, 3.580764452739483*^9}, 
   3.580766726862776*^9, 3.58077145195601*^9, 3.580771643114147*^9, {
   3.580771711991204*^9, 3.58077172726698*^9}, {3.580771760091451*^9, 
   3.580771809734677*^9}, {3.580773482006782*^9, 3.580773486545247*^9}, 
   3.580773644272273*^9, 3.58077368821571*^9, 3.580773765225314*^9, 
   3.580773822265229*^9, 3.580773868656042*^9, 3.580777106153455*^9, 
   3.580778393102353*^9, 3.580778551072476*^9, 3.580778754040413*^9, 
   3.580842371259697*^9, {3.580848003302743*^9, 3.580848057637833*^9}, 
   3.580849608204505*^9, {3.580849957510611*^9, 3.580849971898356*^9}, 
   3.580850087703205*^9, 3.580850132531482*^9, {3.580850237151051*^9, 
   3.580850252210787*^9}, 3.580850381937146*^9, {3.580850803906042*^9, 
   3.580850820230302*^9}, {3.580850931068059*^9, 3.580850940349092*^9}, {
   3.580851534952309*^9, 3.580851581077577*^9}, 3.580852808132929*^9, 
   3.5808529270696*^9, {3.58085299046554*^9, 3.580853030171203*^9}, 
   3.580853478173158*^9, 3.580857862373387*^9, 3.580860408513193*^9, 
   3.58086237815889*^9, {3.581016137419236*^9, 3.581016162091246*^9}, 
   3.581018602875028*^9, 3.581019469948588*^9, 3.581019704395022*^9, 
   3.581019958195545*^9, 3.581020313321648*^9, 3.581020346324158*^9, 
   3.58102064775095*^9, 3.581021161030884*^9, 3.581021192828865*^9, 
   3.58102134560542*^9, 3.58102167871883*^9, 3.581021767559388*^9, 
   3.581023139184173*^9, 3.581023468792723*^9, 3.581024904341086*^9, 
   3.581028253853307*^9, 3.5810288397029*^9, 3.581028913733025*^9, 
   3.581099035795202*^9, 3.581099362335429*^9, 3.581100432996649*^9, 
   3.581101422860704*^9, 3.581103414174957*^9, 3.581105336940593*^9, 
   3.58110905162031*^9, 3.581109178155017*^9, 3.581109516536592*^9, 
   3.58111006034632*^9, 3.58111033542062*^9, 3.581110449836435*^9, 
   3.581110762204292*^9, 3.581113556488668*^9, 3.581113617689966*^9, 
   3.581113662879137*^9, 3.581114019224538*^9, {3.581120228665361*^9, 
   3.581120254041858*^9}, 3.581120475298985*^9, 3.581120557599889*^9, 
   3.581121893773162*^9, 3.581124136559009*^9, 3.581124203514402*^9, {
   3.581124263856774*^9, 3.581124274978007*^9}, 3.581124317343927*^9, {
   3.581124389109431*^9, 3.581124405539411*^9}, 3.581124541100948*^9, 
   3.581124839446727*^9, 3.581124875279239*^9, 3.581124920061087*^9, 
   3.581125092930397*^9, 3.581125279398108*^9, 3.581125357113795*^9, 
   3.581125418824626*^9, 3.581125450614985*^9, 3.581125486682164*^9, 
   3.581131168703098*^9, 3.581186077883707*^9, 3.581186923433724*^9, 
   3.581190913539697*^9, 3.581191691040564*^9, 3.581192126864022*^9, 
   3.5811945828689*^9, 3.581729594548921*^9, 3.581735446056905*^9, 
   3.581737499693535*^9, 3.581737888895653*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Renormalize a by ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "*"], 
     SubscriptBox["H", "*"]}], "=", 
    SubscriptBox["k", "*"]}], TraditionalForm]]],
 " and get horizon crossing values and \[Alpha] to start ptb equations at"
}], "Subsection",
 CellChangeTimes->{{3.580861023668371*^9, 3.580861077975693*^9}, {
  3.580861242857991*^9, 3.580861255289499*^9}}],

Cell[BoxData[{
 RowBox[{"\[Phi]pivot", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"\[Phi]", "[", "\[Alpha]exit", "]"}], "/.", "background"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"d\[Phi]pivot", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{"d\[Phi]", "[", "\[Alpha]exit", "]"}], "/.", "background"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Hpivot", "=", 
   RowBox[{"H", "[", 
    RowBox[{"\[Phi]pivot", ",", "d\[Phi]pivot"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a0", "=", 
   FractionBox["kpivot", 
    RowBox[{"Hpivot", " ", 
     RowBox[{"Exp", "[", "\[Alpha]exit", "]"}]}]]}], " ", 
  RowBox[{"(*", 
   RowBox[{"kpivot", " ", "already", " ", "in", " ", 
    SuperscriptBox[
     SubscriptBox["M", "Pl"], 
     RowBox[{"-", "1"}]]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"a", "[", "\[Alpha]_", "]"}], ":=", 
    RowBox[{"a0", " ", 
     RowBox[{"Exp", "[", "\[Alpha]", "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"FindRoot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "\[Alpha]", "]"}], 
        RowBox[{"H", "[", 
         RowBox[{
          RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], ",", 
          RowBox[{"d\[Phi]", "[", "\[Alpha]", "]"}]}], "]"}]}], "-", 
       FractionBox["kpivot", "100"]}], "}"}], "/.", "background"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "\[Alpha]exit"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Alpha]ptbstart", "=", 
  RowBox[{"\[Alpha]", "/.", "%"}]}]}], "Input",
 CellChangeTimes->{{3.580860367572458*^9, 3.580860530023329*^9}, {
   3.580860575079484*^9, 3.580860596466883*^9}, {3.580860659217977*^9, 
   3.580860768699755*^9}, {3.580860836404599*^9, 3.580860971243172*^9}, {
   3.580861022604508*^9, 3.580861026164611*^9}, {3.580861175489301*^9, 
   3.580861227715222*^9}, {3.580861264661178*^9, 3.580861286134427*^9}, {
   3.580862391917366*^9, 3.58086239749883*^9}, {3.581016683431369*^9, 
   3.581016692805796*^9}, {3.581016800934469*^9, 3.581016801722385*^9}, {
   3.581019359714939*^9, 3.581019366046967*^9}, {3.58102063071803*^9, 
   3.581020668259669*^9}, {3.581021137089752*^9, 3.581021148454119*^9}, {
   3.581021203338404*^9, 3.581021228874886*^9}, 3.5810227597146*^9, {
   3.581022815551893*^9, 3.581022819696647*^9}, 3.581022959697576*^9, {
   3.581028260493553*^9, 3.581028267234335*^9}, {3.581100274122412*^9, 
   3.581100275787448*^9}, 3.581100416150756*^9, {3.581100448747607*^9, 
   3.58110046836569*^9}, {3.581110440606107*^9, 3.581110446440688*^9}, 
   3.581113566661958*^9, 3.581113648952278*^9, {3.581191902464095*^9, 
   3.581191930213539*^9}, {3.581194571344841*^9, 3.581194572564584*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Equations", "Section",
 CellChangeTimes->{{3.580861334401608*^9, 3.580861336685036*^9}}],

Cell["\<\
NOTE: Now time translate background values by time when perturbation \
equations needs to start \[Alpha]ptbstart.  Everything from here down is in \
\[OpenCurlyDoubleQuote]perturbation time.\[CloseCurlyDoubleQuote]\
\>", "Subsection",
 CellChangeTimes->{{3.581737775262983*^9, 3.581737799476516*^9}}],

Cell[CellGroupData[{

Cell[TextData[{
 "ICs for perturbation mode matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Psi]", "IJ"], TraditionalForm]]],
 " in Bunch-Davies vacuum (See Salopek, Bond, Bardeen) based on background \
values when ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["a", "*"], 
     SubscriptBox["H", "*"]}], "=", 
    RowBox[{
     SubscriptBox["k", "*"], "/", "100"}]}], TraditionalForm]]]
}], "Subsection",
 CellChangeTimes->{
  3.58086141069607*^9, {3.580862245105057*^9, 3.580862256738156*^9}, {
   3.581023661097605*^9, 3.581023680505942*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]back", "=", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"\[Phi]", "[", 
       RowBox[{"\[Alpha]", "+", "\[Alpha]ptbstart"}], "]"}], "/.", 
      "background"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]back", "=", 
   RowBox[{
    RowBox[{"Evaluate", "[", 
     RowBox[{
      RowBox[{"d\[Phi]", "[", 
       RowBox[{"\[Alpha]", "+", "\[Alpha]ptbstart"}], "]"}], "/.", 
      "background"}], "]"}], "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Phi]0ptbstart", "=", 
   RowBox[{"\[Phi]back", "/.", 
    RowBox[{"\[Alpha]", "\[Rule]", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Phi]0ptbstart", "=", 
   RowBox[{"d\[Phi]back", "/.", 
    RowBox[{"\[Alpha]", "\[Rule]", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a", "[", "\[Alpha]_", "]"}], ":=", 
   RowBox[{"a0", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{"\[Alpha]", "+", "\[Alpha]ptbstart"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Psi]0", "[", "k_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    FractionBox["1", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"2", "k"}], "]"}]], ")"}], 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "\[Phi]0", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"d\[Psi]0", "[", "k_", "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"-", 
     FractionBox["I", 
      RowBox[{
       RowBox[{"a", "[", "0", "]"}], " ", 
       RowBox[{"H", "[", 
        RowBox[{"\[Phi]0ptbstart", ",", "d\[Phi]0ptbstart"}], "]"}]}]]}], " ",
     ")"}], 
   RowBox[{"Sqrt", "[", 
    FractionBox["k", "2"], "]"}], "I", " ", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "[", "\[Phi]0", "]"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.580677514716848*^9, 3.580677547165261*^9}, {
   3.58067763171722*^9, 3.580677642842213*^9}, {3.580677691201236*^9, 
   3.580677728165931*^9}, {3.580679843069592*^9, 3.580679848817861*^9}, 
   3.580679892823028*^9, {3.580680668070113*^9, 3.580680686535397*^9}, {
   3.580752809607461*^9, 3.580752812456493*^9}, {3.580773489714766*^9, 
   3.580773491346333*^9}, {3.580773928098813*^9, 3.580773939284613*^9}, {
   3.580776910123605*^9, 3.580776920931807*^9}, {3.580861339617579*^9, 
   3.580861377928152*^9}, {3.580862080649263*^9, 3.580862081805961*^9}, {
   3.581016274921014*^9, 3.581016275312068*^9}, {3.581016314472056*^9, 
   3.581016318504898*^9}, {3.581016542114808*^9, 3.581016566858336*^9}, {
   3.581016647305286*^9, 3.581016648158736*^9}, 3.581016706207596*^9, {
   3.581017140002659*^9, 3.581017156340859*^9}, {3.581018355597426*^9, 
   3.581018363054618*^9}, {3.581019226652143*^9, 3.581019238621931*^9}, {
   3.581020918071293*^9, 3.581020920232683*^9}, {3.581021463620774*^9, 
   3.581021493402217*^9}, {3.581021538210041*^9, 3.581021593029205*^9}, {
   3.581024570382129*^9, 3.581024571250366*^9}, {3.581028357332115*^9, 
   3.581028358053155*^9}, {3.581120920023119*^9, 3.581120962003296*^9}, 
   3.581121979449176*^9, {3.581122564015896*^9, 3.581122570350265*^9}, {
   3.581123876747123*^9, 3.581123885687554*^9}, {3.581186862882294*^9, 
   3.581186881231845*^9}, 3.581186917410612*^9, {3.581186955876768*^9, 
   3.581186973128772*^9}, {3.581191941266215*^9, 3.581191973601731*^9}, {
   3.58173588325187*^9, 3.581735937853459*^9}, {3.581737819375191*^9, 
   3.581737846759939*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Functions for ptbs", "Subsection",
 CellChangeTimes->{3.580861399931349*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"MatMul", "[", 
   RowBox[{"vecx_", ",", "vecy_"}], "]"}], ":=", 
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", "vecx", ",", "vecy"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ptbmassmatrix", "[", 
   RowBox[{
    RowBox[{"\[Phi]_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VectorQ", "[", "#", "]"}], " ", "&"}], ")"}]}], ",", 
    RowBox[{"d\[Phi]_", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VectorQ", "[", "#", "]"}], " ", "&"}], ")"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     FractionBox["1.", 
      RowBox[{"H2", "[", 
       RowBox[{"\[Phi]", ",", "d\[Phi]"}], "]"}]], ")"}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"m2matrix", "[", "\[Phi]", "]"}], "+", 
      RowBox[{"MatMul", "[", 
       RowBox[{"d\[Phi]", ",", 
        RowBox[{"dVd\[Phi]", "[", "\[Phi]", "]"}]}], "]"}], "+", 
      RowBox[{"MatMul", "[", 
       RowBox[{
        RowBox[{"dVd\[Phi]", "[", "\[Phi]", "]"}], ",", "d\[Phi]"}], "]"}]}], 
     ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"3.", "-", 
      RowBox[{"\[Epsilon]", "[", "d\[Phi]", "]"}]}], ")"}], 
    RowBox[{"MatMul", "[", 
     RowBox[{"d\[Phi]", ",", "d\[Phi]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.580677017382814*^9, 3.580677049393753*^9}, {
   3.580677145465765*^9, 3.580677215646185*^9}, {3.580677320178735*^9, 
   3.580677371538552*^9}, {3.580678095791572*^9, 3.580678102750582*^9}, {
   3.580678136011087*^9, 3.580678140068411*^9}, {3.580678318019066*^9, 
   3.580678351319561*^9}, {3.580678383730328*^9, 3.580678392645887*^9}, {
   3.580678632775383*^9, 3.580678764824156*^9}, {3.580679911800038*^9, 
   3.580679912441682*^9}, 3.58068163227066*^9, 3.580681752321387*^9, {
   3.580766527983409*^9, 3.580766528962391*^9}, {3.58077693819866*^9, 
   3.580776968481544*^9}, 3.580776999920064*^9, {3.580843910516673*^9, 
   3.580843912906079*^9}, 3.580861384845894*^9, 3.580861416774145*^9, {
   3.580861512921514*^9, 3.580861514529205*^9}, {3.580861555424964*^9, 
   3.58086155718249*^9}, {3.580861853668294*^9, 3.580861923175093*^9}, {
   3.581018267793787*^9, 3.581018282609487*^9}, {3.581019883160957*^9, 
   3.581019895925774*^9}, {3.581019930931962*^9, 3.581019949252155*^9}, {
   3.581020333039264*^9, 3.581020335501047*^9}, {3.581021373810465*^9, 
   3.581021376321595*^9}, {3.581030024297091*^9, 3.581030027662826*^9}, {
   3.581191981675585*^9, 3.581191987242748*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Mass Matrix Plots --- for Jonny", "Subsection",
 CellChangeTimes->{{3.581734063830415*^9, 3.581734072015082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"plotstart", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{"ptbmassmatrix", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "/.", "background"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Evaluate", "[", 
            RowBox[{
             RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "/.", "background"}], 
            "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Alpha]", ",", "\[Alpha]ptbstart", ",", "\[Alpha]end"}], 
         "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
        RowBox[{"Frame", "\[Rule]", "True"}], ",", 
        RowBox[{"FrameLabel", "\[Rule]", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"#", ",", "20"}], "]"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Alpha]", ",", "C"}], "}"}]}], "]"}]}]}], "]"}], 
      "\[IndentingNewLine]", "plotexit"}], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"ptbmassmatrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "/.", "background"}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "/.", "background"}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "\[Alpha]exit", ",", "\[Alpha]end"}], 
          "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", "20"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "C"}], "}"}]}], "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", "plot44"}], "=", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"ptbmassmatrix", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "/.", "background"}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{"Evaluate", "[", 
             RowBox[{
              RowBox[{"\[Phi]", "[", "\[Alpha]", "]"}], "/.", "background"}], 
             "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Alpha]", ",", "44", ",", "\[Alpha]end"}], "}"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
         RowBox[{"Frame", "\[Rule]", "True"}], ",", 
         RowBox[{"FrameLabel", "\[Rule]", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"#", ",", "20"}], "]"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Alpha]", ",", "C"}], "}"}]}], "]"}]}]}], "]"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<ptbmassmatrix_start.pdf\>\"", ",", "plotstart"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<ptbmassmatrix_exit.pdf\>\"", ",", "plotexit"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Export", "[", 
        RowBox[{"\"\<ptbmassmatrix_zoom.pdf\>\"", ",", "plot44"}], 
        "]"}]}]}]}]}], "*)"}], "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.581733854685215*^9, 3.581733982572947*^9}, {
  3.581734024536077*^9, 3.581734048753995*^9}, {3.581734305137095*^9, 
  3.581734379529334*^9}, {3.581734415624216*^9, 3.581734501668386*^9}, {
  3.581734581286646*^9, 3.581734604854637*^9}, {3.58173473971549*^9, 
  3.581734755669199*^9}, {3.581737489418613*^9, 3.581737491943502*^9}, {
  3.581737569617326*^9, 3.581737570979381*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbed, Fourier-transformed Equations", "Subsection",
 CellChangeTimes->{{3.580861431321576*^9, 3.580861439227191*^9}}],

Cell["\<\
Reset integration start time \[Alpha] --> \[Alpha]\[CloseCurlyQuote]=\[Alpha] \
- \[Alpha]ptbstart\
\>", "Text",
 CellChangeTimes->{{3.581022462801819*^9, 3.581022486626168*^9}, {
  3.581024847998138*^9, 3.581024875183932*^9}, {3.581029984242992*^9, 
  3.58102998540264*^9}, {3.581110248101845*^9, 3.581110276397573*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ptbeqn", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"d\[Psi]", "'"}], "[", "\[Alpha]", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"\[Epsilon]", "[", "d\[Phi]back", "]"}]}], ")"}], 
        RowBox[{"d\[Psi]", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            FractionBox["kpivot", 
             RowBox[{
              RowBox[{"a", "[", "\[Alpha]", "]"}], " ", 
              RowBox[{"H", "[", 
               RowBox[{"\[Phi]back", ",", "d\[Phi]back"}], "]"}]}]], ")"}], 
           "2"], "-", "2", "+", 
          RowBox[{"\[Epsilon]", "[", "d\[Phi]back", "]"}]}], ")"}], 
        RowBox[{"\[Psi]", "[", "\[Alpha]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"ptbmassmatrix", "[", 
         RowBox[{"\[Phi]back", ",", "d\[Phi]back"}], "]"}], ".", 
        RowBox[{"\[Psi]", "[", "\[Alpha]", "]"}]}]}], "\[Equal]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"\[Psi]", "'"}], "[", "\[Alpha]", "]"}], "\[Equal]", 
      RowBox[{"d\[Psi]", "[", "\[Alpha]", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Psi]", "[", "0", "]"}], "\[Equal]", 
      RowBox[{"\[Psi]0", "[", "kpivot", "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"d\[Psi]", "[", "0", "]"}], "\[Equal]", 
      RowBox[{"d\[Psi]0", "[", "kpivot", "]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.580678117953779*^9, 3.580678126050189*^9}, {
   3.580678787067428*^9, 3.580678817313135*^9}, {3.580678852283752*^9, 
   3.580678900225189*^9}, {3.580679120123327*^9, 3.580679313894092*^9}, {
   3.580679344230327*^9, 3.580679408985338*^9}, {3.580679696766883*^9, 
   3.580679702875322*^9}, {3.580679754462746*^9, 3.580679834215451*^9}, {
   3.580679885269579*^9, 3.580679886341009*^9}, {3.580680698987757*^9, 
   3.580680720587971*^9}, 3.580680777497466*^9, {3.580776948812899*^9, 
   3.580777017490957*^9}, {3.580861441378842*^9, 3.580861441728028*^9}, {
   3.580861576356232*^9, 3.580861605778849*^9}, {3.580861636207748*^9, 
   3.580861745241759*^9}, 3.581016289392781*^9, {3.581016326879495*^9, 
   3.58101633540519*^9}, {3.581016412167259*^9, 3.581016432706567*^9}, {
   3.581016656147826*^9, 3.581016669010982*^9}, 3.581017164137957*^9, {
   3.581017836648186*^9, 3.581017839165462*^9}, {3.581019139227153*^9, 
   3.581019163564673*^9}, {3.581019249282745*^9, 3.581019311672375*^9}, {
   3.581019555774236*^9, 3.581019561149734*^9}, {3.581019608841438*^9, 
   3.581019631317381*^9}, {3.581020409577232*^9, 3.581020423181994*^9}, 
   3.581020902564185*^9, {3.581020937124782*^9, 3.5810209990597*^9}, {
   3.581021061635434*^9, 3.581021122605478*^9}, 3.581021323318601*^9, {
   3.581021400621139*^9, 3.581021408658088*^9}, {3.581021642674058*^9, 
   3.581021646374222*^9}, {3.581022437001797*^9, 3.581022440754794*^9}, {
   3.581024700859285*^9, 3.581024704728448*^9}, 3.581024886983018*^9, {
   3.581028367126455*^9, 3.581028441168804*^9}, {3.581028527823369*^9, 
   3.581028536342776*^9}, {3.581028698550883*^9, 3.581028793363576*^9}, {
   3.581028975713616*^9, 3.581029012802355*^9}, {3.581029376661534*^9, 
   3.581029466074291*^9}, {3.581029627272117*^9, 3.581029710381566*^9}, {
   3.581029765154381*^9, 3.58102980277321*^9}, {3.581099061535013*^9, 
   3.581099083164635*^9}, {3.581099407537268*^9, 3.581099408938094*^9}, {
   3.581099446549917*^9, 3.581099447335103*^9}, {3.58109948305082*^9, 
   3.58109956692342*^9}, {3.581102773541575*^9, 3.581102777269443*^9}, {
   3.581103200939432*^9, 3.581103202350064*^9}, 3.581103424968124*^9, 
   3.581120876957618*^9, 3.581186370631814*^9, {3.581192063419022*^9, 
   3.581192082577107*^9}, {3.581192118943347*^9, 3.581192249950664*^9}, {
   3.581192282817771*^9, 3.581192285194783*^9}, 3.581196857955626*^9, 
   3.581734766302851*^9, {3.581735524799501*^9, 3.581735594550671*^9}, {
   3.581735703793553*^9, 3.581735750627966*^9}, 3.581737856810261*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Perturbation Solver", "Section",
 CellChangeTimes->{{3.58101866118611*^9, 3.581018663578479*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Alpha]ptbend", "=", 
   RowBox[{"\[Alpha]end", "-", "\[Alpha]ptbstart"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"perturbations", "=", 
   RowBox[{"NDSolve", "[", 
    RowBox[{"ptbeqn", ",", 
     RowBox[{"{", 
      RowBox[{"\[Psi]", ",", "d\[Psi]"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Alpha]", ",", "0", ",", "\[Alpha]ptbend"}], "}"}], ",", 
     RowBox[{"MaxSteps", "\[Rule]", "Infinity"}]}], "]"}]}], ";"}]}], "Input",
 
 CellChangeTimes->{{3.581018513474157*^9, 3.581018549975283*^9}, {
   3.581018583647374*^9, 3.581018587906247*^9}, {3.581018679611301*^9, 
   3.581018679800067*^9}, {3.581021009900079*^9, 3.581021013834379*^9}, {
   3.581021256946977*^9, 3.58102126351027*^9}, 3.581022449243966*^9, {
   3.581022532367184*^9, 3.581022534418724*^9}, {3.581023373547568*^9, 
   3.581023376597538*^9}, {3.5810234456989*^9, 3.581023446495043*^9}, {
   3.581024985838308*^9, 3.581024990986388*^9}, {3.581025358025839*^9, 
   3.581025359442021*^9}, {3.581025689811959*^9, 3.581025713613794*^9}, {
   3.581025858873425*^9, 3.58102585900554*^9}, {3.581025894251704*^9, 
   3.581025923177401*^9}, 3.58102595915778*^9, {3.581028421796294*^9, 
   3.581028421961252*^9}, {3.581028538505994*^9, 3.581028554917521*^9}, {
   3.581028662467747*^9, 3.581028695983664*^9}, {3.581029018591624*^9, 
   3.581029068606206*^9}, {3.581029117909729*^9, 3.581029126181575*^9}, 
   3.581029260919246*^9, 3.581099090958651*^9, {3.581099128119029*^9, 
   3.581099142236141*^9}, {3.581099400199413*^9, 3.581099475452018*^9}, 
   3.581099528337769*^9, {3.581099609190239*^9, 3.581099629251879*^9}, {
   3.581100800348412*^9, 3.581100856642622*^9}, {3.5811030243193*^9, 
   3.581103084476979*^9}, {3.5811037934846*^9, 3.581103794457368*^9}, {
   3.581103913373595*^9, 3.581103941118917*^9}, {3.581106008240695*^9, 
   3.581106016611587*^9}, {3.58110626585487*^9, 3.58110626802489*^9}, {
   3.581106849952413*^9, 3.581106850255253*^9}, 3.581110369877507*^9, {
   3.581190928666359*^9, 3.581190931585638*^9}, {3.581192903410112*^9, 
   3.581192903526695*^9}, 3.581734770773187*^9, 3.581735597952561*^9, 
   3.581735746316165*^9, {3.581735970727286*^9, 3.581735986612779*^9}, {
   3.581736340665435*^9, 3.581736346337231*^9}, {3.581736894973149*^9, 
   3.581736896007554*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Power Spectrum", "Section",
 CellChangeTimes->{{3.581023840577506*^9, 3.581023842656553*^9}}],

Cell[CellGroupData[{

Cell["Slow-Roll Approximation for Power Spectrum", "Subsection",
 CellChangeTimes->{{3.581191733265774*^9, 3.581191740728502*^9}}],

Cell[BoxData[{
 RowBox[{"PowerSpectrumHorizonCross", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"V", "[", "\[Phi]pivot", "]"}], 
    RowBox[{"24", " ", 
     SuperscriptBox["\[Pi]", "2"]}]], 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"\[Epsilon]SR", "[", "\[Phi]pivot", "]"}]], ",", 
     FractionBox["1", 
      RowBox[{"\[Epsilon]", "[", "d\[Phi]pivot", "]"}]]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"PowerSpectrumSR", "=", 
  RowBox[{
   FractionBox["Npivot", 
    RowBox[{"4", " ", 
     SuperscriptBox["\[Pi]", "2"]}]], " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"H2SR", "[", "\[Phi]pivot", "]"}], ",", 
     RowBox[{"H2", "[", 
      RowBox[{"\[Phi]pivot", ",", "d\[Phi]pivot"}], "]"}]}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.581191742965776*^9, 3.58119174808555*^9}, {
   3.581194444085299*^9, 3.581194560206105*^9}, {3.581195453502811*^9, 
   3.581195521330216*^9}, 3.581195580843091*^9, {3.581195617988141*^9, 
   3.581195722880807*^9}, {3.581197072641759*^9, 3.581197080023364*^9}, {
   3.581734778269116*^9, 3.581734780031992*^9}, {3.58173700349927*^9, 
   3.581737005360466*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Numerical Evaluation", "Subsection",
 CellChangeTimes->{{3.581195316049045*^9, 3.581195318769663*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"PowerSpectrum", "[", "\[Alpha]_", "]"}], ":=", 
   RowBox[{
    FractionBox[
     SuperscriptBox["kpivot", "3"], 
     RowBox[{"2", 
      SuperscriptBox["\[Pi]", "2"], 
      SuperscriptBox[
       RowBox[{"a", "[", "\[Alpha]", "]"}], "2"]}]], 
    RowBox[{"Flatten", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Psi]", "[", "\[Alpha]", "]"}], ".", 
        RowBox[{"Conjugate", "[", 
         RowBox[{"\[Psi]", "[", "\[Alpha]", "]"}], "]"}]}], "/.", 
       "perturbations"}], ",", "1"}], "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PowerSpectrumAdiabatic", "[", "t_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"d\[Phi]0", ",", "\[Omega]"}], "}"}], ",", 
    RowBox[{
     RowBox[{"d\[Phi]0", "=", 
      RowBox[{
       RowBox[{"Sqrt", "[", 
        RowBox[{"d\[Phi]back", ".", "d\[Phi]back"}], "]"}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", "t"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Omega]", "=", 
      RowBox[{
       FractionBox["d\[Phi]back", "d\[Phi]0"], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", "t"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        FractionBox["1.0", 
         RowBox[{"2.0", 
          RowBox[{"\[Epsilon]", "[", "d\[Phi]back", "]"}]}]], ")"}], 
       RowBox[{"\[Omega]", ".", 
        RowBox[{"(", 
         RowBox[{"\[Omega]", ".", 
          RowBox[{"PowerSpectrum", "[", "t", "]"}]}], ")"}]}]}], "/.", 
      RowBox[{"\[Alpha]", "\[Rule]", "t"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", 
  RowBox[{"\"\<Numerical -- Inflation End: \>\"", ",", 
   RowBox[{"PowerSpectrumAdiabatic", "[", "\[Alpha]ptbend", "]"}], ",", 
   "\[IndentingNewLine]", "\"\<\\nNumerical -- Horiz Cross: \>\"", ",", " ", 
   RowBox[{"PowerSpectrumAdiabatic", "[", "\[Alpha]exit", "]"}], ",", 
   "\[IndentingNewLine]", " ", "\"\<\\nSlowroll: \>\"", ",", 
   RowBox[{"PowerSpectrumSR", "[", 
    RowBox[{"[", "1", "]"}], "]"}], ",", "\[IndentingNewLine]", " ", 
   "\"\<\\nHorizon Crossing: \>\"", ",", 
   RowBox[{"PowerSpectrumHorizonCross", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "\[IndentingNewLine]"}], "Input",
 
 CellChangeTimes->{{3.581736269747134*^9, 3.581736327053114*^9}, {
   3.581736392517582*^9, 3.581736425211635*^9}, {3.581736469108526*^9, 
   3.581736492050415*^9}, {3.581736552343098*^9, 3.581736764143012*^9}, {
   3.581737118979015*^9, 3.581737329559367*^9}, 3.58173786813163*^9, {
   3.581737914011403*^9, 3.581737937260807*^9}}],

Cell[BoxData[{
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"PowerSpectrum", "[", "t", "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "\[Alpha]ptbend"}], "}"}], ",", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "20"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]", "-", 
         SubscriptBox["\[Alpha]", "start"]}], ",", 
        SubscriptBox["P", "IJ"]}], "}"}]}], "]"}]}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"PowerSpectrumAdiabatic", "[", "\[Alpha]", "]"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Alpha]", ",", 
     RowBox[{"1", 
      RowBox[{"(", 
       RowBox[{"\[Alpha]exit", "-", "1", "-", "\[Alpha]ptbstart"}], ")"}]}], 
     ",", "\[Alpha]ptbend"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
   RowBox[{"GridLines", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[Alpha]exit", "-", "\[Alpha]ptbstart"}], "}"}], ",", 
      RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
   RowBox[{"Frame", "\[Rule]", "True"}], ",", 
   RowBox[{"FrameLabel", "\[Rule]", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "20"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Alpha]", "-", 
         SubscriptBox["\[Alpha]", "start"]}], ",", 
        SubscriptBox["P", "\[Zeta]\[Zeta]"]}], "}"}]}], "]"}]}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.581187716860069*^9, 3.581187757282834*^9}, {
   3.581187918841856*^9, 3.581187922785975*^9}, {3.581188086363215*^9, 
   3.581188153492138*^9}, {3.581196720279841*^9, 3.5811967833894*^9}, 
   3.581735200694722*^9, {3.581735306038451*^9, 3.581735324411457*^9}, 
   3.581735957565095*^9, {3.581735996200313*^9, 3.581735999540376*^9}, {
   3.581736244007571*^9, 3.581736252264998*^9}, {3.581736287990309*^9, 
   3.581736303388208*^9}, {3.581736859835638*^9, 3.581736880156253*^9}, {
   3.581737127305766*^9, 3.581737127450693*^9}, {3.581737601585133*^9, 
   3.581737649652005*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Other Plots", "Section",
 CellChangeTimes->{{3.580857804769645*^9, 3.580857805251494*^9}, {
  3.581195329409052*^9, 3.581195329872547*^9}}],

Cell[BoxData[{
 RowBox[{"plotfrommathematica", "=", 
  RowBox[{"Show", "[", 
   RowBox[{
    RowBox[{"ParametricPlot", "[", 
     RowBox[{
      RowBox[{"Evaluate", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"\[Phi]", "[", "t", "]"}], "}"}], "/.", "background"}], 
       "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "\[Alpha]end"}], "}"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", "Thick"}], "}"}]}], ",", 
      RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"#", ",", "20"}], "]"}], "&"}], ",", 
         RowBox[{"{", 
          RowBox[{
           SubscriptBox["\[Phi]", "1"], ",", 
           SubscriptBox["\[Phi]", "2"]}], "}"}]}], "]"}]}]}], "]"}], ",", 
    RowBox[{"ListPlot", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"\[Phi]", "[", "0", "]"}], "}"}], "/.", "background"}], ",", 
      RowBox[{"PlotMarkers", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Medium"}], "}"}]}], ",", 
      RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
      RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"ParametricPlot", "[", 
    RowBox[{
     RowBox[{"Evaluate", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"d\[Phi]", "[", "t", "]"}], "}"}], "/.", "background"}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"t", ",", "0", ",", "\[Alpha]end"}], "}"}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"{", "Thick", "}"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}], ",", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Style", "[", 
         RowBox[{
          SubscriptBox["d\[Phi]", "1"], ",", "20"}], "]"}], ",", 
        RowBox[{"Style", "[", 
         RowBox[{
          SubscriptBox["d\[Phi]", "2"], ",", "20"}], "]"}]}], "}"}]}]}], 
    "]"}], ",", 
   RowBox[{"ListPlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"d\[Phi]", "[", "0", "]"}], "}"}], "/.", "background"}], ",", 
     RowBox[{"PlotMarkers", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"Automatic", ",", "Medium"}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", "Black"}], ",", 
     RowBox[{"Frame", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.580680893952681*^9, 3.580680898960688*^9}, {
  3.580680933437632*^9, 3.580680959485598*^9}, {3.580681113476451*^9, 
  3.580681166497718*^9}, {3.580681200283665*^9, 3.580681201867835*^9}, {
  3.580681239131625*^9, 3.580681292647827*^9}, {3.580684616378604*^9, 
  3.580684630443976*^9}, {3.580774066100922*^9, 3.580774121185184*^9}, {
  3.580776698024071*^9, 3.580776790641773*^9}, {3.58077682353939*^9, 
  3.580776850916659*^9}, {3.580779986599825*^9, 3.580780019626999*^9}, {
  3.580780140272175*^9, 3.580780172042385*^9}, {3.580842326025479*^9, 
  3.580842361839114*^9}}],

Cell[BoxData[
 RowBox[{"Show", "[", 
  RowBox[{"Plot", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Epsilon]", "[", 
      RowBox[{"d\[Phi]", "[", "t", "]"}], "]"}], "/.", "background"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "\[Alpha]end"}], "}"}], ",", 
    RowBox[{"PlotRange", "\[Rule]", "All"}], ",", 
    RowBox[{"Frame", "\[Rule]", "True"}], ",", 
    RowBox[{"FrameLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\[Alpha]", ",", "20"}], "]"}], ",", 
       RowBox[{"Style", "[", 
        RowBox[{"\[Epsilon]", ",", "20"}], "]"}]}], "}"}]}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.580773493062811*^9, 3.580773616256361*^9}, {
   3.580773750650866*^9, 3.580773761294973*^9}, {3.580773876699273*^9, 
   3.58077392254605*^9}, {3.580773973636447*^9, 3.580774042792511*^9}, {
   3.58077430699439*^9, 3.580774309367785*^9}, {3.58077435038489*^9, 
   3.580774409479475*^9}, {3.580776865960073*^9, 3.580776884010333*^9}, {
   3.580848075329956*^9, 3.580848086065151*^9}, {3.58102377247876*^9, 
   3.581023781889172*^9}, 3.58110916298096*^9, {3.581114099632639*^9, 
   3.581114100649552*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "SetDirectory", "[", 
     "\"\</home/lpri691/Cosmology_Research/F_projects/ModeCode/ModeCode_\
multifield/mathematica_nbs\>\"", "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"data", "=", 
     RowBox[{"Import", "[", 
      RowBox[{"\"\<phiarr.txt\>\"", ",", "\"\<Table\>\""}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data\[Alpha]", "=", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "1"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data\[Phi]1", "=", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"data\[Phi]2", "=", 
     RowBox[{"data", "[", 
      RowBox[{"[", 
       RowBox[{"All", ",", "3"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"plotfrommodecode", "=", 
    RowBox[{"ListPlot", "[", 
     RowBox[{"Thread", "[", 
      RowBox[{"{", 
       RowBox[{"data\[Phi]1", ",", "data\[Phi]2"}], "}"}], "]"}], 
     "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.580778815655106*^9, 3.580778881901794*^9}, {
  3.580778929410619*^9, 3.580778971691516*^9}, {3.580779007509588*^9, 
  3.580779017188981*^9}, {3.580779446182857*^9, 3.580779446509118*^9}, {
  3.580779523974566*^9, 3.580779524639291*^9}, {3.58077988021363*^9, 
  3.580779976734118*^9}, {3.581737691964715*^9, 3.581737693134506*^9}}],

Cell[BoxData[
 RowBox[{"compare", "=", 
  RowBox[{"Show", "[", 
   RowBox[{"plotfrommathematica", ",", "plotfrommodecode"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.58077998010501*^9, 3.580779999083439*^9}, {
  3.580780036683686*^9, 3.580780037259289*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Export", "[", 
   RowBox[{"\"\<compare.png\>\"", ",", "compare"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.580780041159386*^9, 3.58078006926813*^9}, {
  3.581114076470098*^9, 3.581114087205311*^9}}],

Cell[BoxData[
 RowBox[{"<<", "StatisticalPlots`"}]], "Input",
 CellChangeTimes->{{3.580779263549777*^9, 3.580779268065075*^9}}],

Cell[BoxData[
 RowBox[{"PairwiseScatterPlot", "[", 
  RowBox[{"data", ",", 
   RowBox[{"DataLabels", "->", 
    RowBox[{"Map", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"TraditionalForm", "[", 
        RowBox[{"Style", "[", 
         RowBox[{"#", ",", "20"}], "]"}], "]"}], "&"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Alpha]", ",", "\[Phi]", ",", "\[Psi]"}], "}"}]}], "]"}]}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.580779341522683*^9, 3.580779346909063*^9}, 
   3.580779381608653*^9, {3.580779450493056*^9, 3.580779457051846*^9}, {
   3.580779558918091*^9, 3.580779653852216*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1621, 1026},
WindowMargins->{{-7, Automatic}, {Automatic, 0}},
PrivateNotebookOptions->{"FileOutlineCache"->False},
FrontEndVersion->"8.0 for Linux x86 (32-bit) (October 10, 2011)",
StyleDefinitions->"Default.nb"
]

